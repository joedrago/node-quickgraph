// Generated by CoffeeScript 1.10.0
(function() {
  var QuickGraph, fs, main, path;

  fs = require('fs');

  path = require('path');

  QuickGraph = require('./quickgraph');

  main = function() {
    var aliases, args, d, dir, err, filename, i, j, len, len1, line, lines, matches, qg, ref, ref1;
    aliases = {};
    ref = ['HOME', 'USERPROFILE'];
    for (i = 0, len = ref.length; i < len; i++) {
      d = ref[i];
      dir = process.env[d];
      if (dir == null) {
        continue;
      }
      filename = path.join(dir, '.quickgraphrc');
      if (fs.existsSync(filename)) {
        lines = String(fs.readFileSync(filename)).split(/[\r\n]/);
        for (j = 0, len1 = lines.length; j < len1; j++) {
          line = lines[j];
          if (matches = line.match(/^(\S+)\s+(.+)$/)) {
            aliases[matches[1]] = matches[2];
          }
        }
      }
    }
    qg = new QuickGraph(aliases);
    args = process.argv.slice(2);
    if (args.length === 0) {
      args = ['-h'];
    }
    if (!qg.parseArguments(args)) {
      if (qg.error) {
        console.log("Parse error: " + qg.error);
      }
      return false;
    }
    if (!qg.execute()) {
      err = (ref1 = qg.error) != null ? ref1 : "Unknown";
      console.log("Execute error: " + err);
      return false;
    }
    return qg.generate();
  };

  module.exports = main;

}).call(this);
